@{
	ViewData["Title"] = "Lecturer Dashboard";
	var recentClaims = ViewBag.RecentClaims as List<CMCS.Web.Models.Claim> ?? new List<CMCS.Web.Models.Claim>();
}

<div class="row">
	<div class="col-12">
		<h1 class="mb-1">Lecturer Dashboard</h1>
		<p class="text-muted mb-4">Welcome back! Here's an overview of your claims</p>

		<!-- Statistics Cards -->
		<div class="row g-4 mb-4">
			<div class="col-md-3">
				<div class="card border-0">
					<div class="card-body text-center p-4">
						<div class="display-4 text-primary mb-2 fw-bold">@ViewBag.TotalClaims</div>
						<h6 class="text-muted mb-0 text-uppercase small">Total Claims</h6>
					</div>
				</div>
			</div>
			<div class="col-md-3">
				<div class="card border-0">
					<div class="card-body text-center p-4">
						<div class="display-4 text-warning mb-2 fw-bold">@ViewBag.PendingClaims</div>
						<h6 class="text-muted mb-0 text-uppercase small">Pending Review</h6>
					</div>
				</div>
			</div>
			<div class="col-md-3">
				<div class="card border-0">
					<div class="card-body text-center p-4">
						<div class="display-4 text-success mb-2 fw-bold">@ViewBag.ApprovedClaims</div>
						<h6 class="text-muted mb-0 text-uppercase small">Approved</h6>
					</div>
				</div>
			</div>
			<div class="col-md-3">
				<div class="card border-0">
					<div class="card-body text-center p-4">
						<div class="display-6 text-success mb-2 fw-bold">R @ViewBag.TotalAmount.ToString("N2")</div>
						<h6 class="text-muted mb-0 text-uppercase small">Total Approved</h6>
					</div>
				</div>
			</div>
		</div>

		<!-- Quick Actions -->
		<div class="row g-4 mb-4">
			<div class="col-md-4">
				<div class="card border-0 h-100">
					<div class="card-body d-flex flex-column p-4">
						<div class="text-center mb-3">
							<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" class="text-primary" viewBox="0 0 16 16">
								<path d="M5 0h8a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2 2 2 0 0 1-2 2H3a2 2 0 0 1-2-2h1a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1H1a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v9a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H5a1 1 0 0 0-1 1H3a2 2 0 0 1 2-2"/>
								<path d="M1 6v-.5a.5.5 0 0 1 1 0V6h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1zm0 3v-.5a.5.5 0 0 1 1 0V9h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1zm0 2.5v.5H.5a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1H2v-.5a.5.5 0 0 0-1 0"/>
							</svg>
						</div>
						<h5 class="card-title text-center mb-2">Submit a Claim</h5>
						<p class="card-text text-center text-muted flex-grow-1 small">Create and submit your monthly claim</p>
						<a class="btn btn-primary w-100 mt-3" asp-controller="Lecturer" asp-action="Submit">Submit New Claim</a>
					</div>
				</div>
			</div>
			<div class="col-md-4">
				<div class="card border-0 h-100">
					<div class="card-body d-flex flex-column p-4">
						<div class="text-center mb-3">
							<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" class="text-success" viewBox="0 0 16 16">
								<path d="M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"/>
								<path d="M3 12.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5"/>
							</svg>
						</div>
						<h5 class="card-title text-center mb-2">My Claims</h5>
						<p class="card-text text-center text-muted flex-grow-1 small">View and track all your claims</p>
						<a class="btn btn-outline-success w-100 mt-3" asp-controller="Lecturer" asp-action="MyClaims">View All Claims</a>
					</div>
				</div>
			</div>
			<div class="col-md-4">
				<div class="card border-0 h-100">
					<div class="card-body d-flex flex-column p-4">
						<div class="text-center mb-3">
							<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" class="text-info" viewBox="0 0 16 16">
								<path d="M9.293 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.707A1 1 0 0 0 13.707 4L10 .293A1 1 0 0 0 9.293 0M9.5 3.5v-2l3 3h-2a1 1 0 0 1-1-1M4.5 9a.5.5 0 0 1 0-1h7a.5.5 0 0 1 0 1zM4 10.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5m.5 2.5a.5.5 0 0 1 0-1h4a.5.5 0 0 1 0 1z"/>
							</svg>
						</div>
						<h5 class="card-title text-center mb-2">Upload Documents</h5>
						<p class="card-text text-center text-muted flex-grow-1 small">Attach supporting documents</p>
						<a class="btn btn-outline-info w-100 mt-3" asp-controller="Lecturer" asp-action="MyClaims">Manage Documents</a>
					</div>
				</div>
			</div>
		</div>

		<!-- Recent Claims with Status -->
		@if (recentClaims.Any())
		{
			<div class="card border-0">
				<div class="card-header bg-white">
					<h5 class="card-title mb-0">Recent Claims & Status</h5>
				</div>
				<div class="card-body p-0">
					<div class="table-responsive">
						<table class="table table-hover mb-0">
							<thead class="table-light">
								<tr>
									<th>Claim #</th>
									<th>Period</th>
									<th>Amount</th>
									<th>Status</th>
									<th>Progress</th>
									<th class="text-center">Actions</th>
								</tr>
							</thead>
							<tbody>
								@foreach (var claim in recentClaims)
								{
									var monthName = new DateTime(claim.Year, claim.Month, 1).ToString("MMMM");
									var statusViewModel = CMCS.Web.Models.ViewModels.ClaimStatusHelper.GetStatusViewModel(claim);
									var statusClass = CMCS.Web.Models.ViewModels.ClaimStatusHelper.GetStatusBadgeClass(claim.Status);

									<tr>
										<td class="fw-bold">#@claim.Id</td>
										<td>@monthName @claim.Year</td>
										<td class="fw-semibold">R @claim.Amount.ToString("N2")</td>
										<td>
											<span class="badge @statusClass">
												@CMCS.Web.Models.ViewModels.ClaimStatusHelper.GetStatusIcon(claim.Status) @claim.Status
											</span>
										</td>
										<td style="width: 200px;">
											@if (claim.Status != CMCS.Web.Models.ClaimStatus.Rejected)
											{
												<div class="progress" style="height: 20px;">
													<div class="progress-bar bg-@statusViewModel.StatusColor" 
														 role="progressbar" 
														 style="width: @statusViewModel.ProgressPercentage%;" 
														 aria-valuenow="@statusViewModel.ProgressPercentage" 
														 aria-valuemin="0" 
														 aria-valuemax="100">
														@statusViewModel.ProgressPercentage%
													</div>
												</div>
											}
											else
											{
												<span class="badge bg-danger">Rejected</span>
											}
										</td>
										<td class="text-center">
											<a asp-action="TrackClaim" asp-route-id="@claim.Id" class="btn btn-sm btn-outline-primary">
												Track Status
											</a>
										</td>
									</tr>
								}
							</tbody>
						</table>
					</div>
				</div>
				<div class="card-footer text-center">
					<a asp-action="MyClaims" class="btn btn-sm btn-outline-primary">View All Claims â†’</a>
				</div>
			</div>
		}
		else
		{
			<div class="card border-0">
				<div class="card-body text-center py-5">
					<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" fill="currentColor" class="text-muted mb-4" viewBox="0 0 16 16">
						<path d="M5 0h8a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2 2 2 0 0 1-2 2H3a2 2 0 0 1-2-2h1a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1H1a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v9a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H5a1 1 0 0 0-1 1H3a2 2 0 0 1 2-2"/>
						<path d="M1 6v-.5a.5.5 0 0 1 1 0V6h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1zm0 3v-.5a.5.5 0 0 1 1 0V9h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1zm0 2.5v.5H.5a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0 1H2v-.5a.5.5 0 0 0-1 0"/>
					</svg>
					<h5>No Claims Yet</h5>
					<p class="text-muted">Start by submitting your first claim</p>
					<a asp-action="Submit" class="btn btn-primary mt-2">Submit Your First Claim</a>
				</div>
			</div>
		}
	</div>
</div>


